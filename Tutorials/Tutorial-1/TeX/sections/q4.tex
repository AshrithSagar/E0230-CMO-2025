\section*{Question 4}

Suppose \( f \in C_{L}^{1} \), where \( L>0 \); that is, \( {\Vert \nabla f(x)-\nabla f(y) \Vert}_{2} \leq L {\Vert x-y \Vert}_{2} \).
If \( f \in C_{L}^{1} \), show that the functions \( g(x)=\frac{L}{2} x^{\top} x-f(x) \) and \( h(x)=\frac{L}{2} x^{\top} x+f(x) \) are convex.
Then, show that \( -\frac{L}{2}\|y-x\|^{2} \leq f(y)-f(x)-\langle\nabla f(x), y-x\rangle \leq \frac{L}{2}\|y-x \Vert^{2} \).

\subsection*{Solution}

Since \( f \in C_{L}^{1} \), we have that \( \nabla f \) is Lipschitz continuous with constant \( L \), i.e.,
\begin{equation*}
    {\Vert \nabla f(\mathbf{x}) - \nabla f(\mathbf{y}) \Vert}_{2}
    \leq
    L {\Vert \mathbf{x} - \mathbf{y} \Vert}_{2},
    \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{equation*}

Now, from Cauchy-Schwarz inequality, we have that
\begin{equation*}
    \big\vert {(\nabla f(\mathbf{x}) - \nabla f(\mathbf{y}))}^{\top} (\mathbf{x} - \mathbf{y}) \big\vert
    \leq
    {\Vert \nabla f(\mathbf{x}) - \nabla f(\mathbf{y}) \Vert}_{2} \; {\Vert \mathbf{x} - \mathbf{y} \Vert}_{2}
    \leq
    L {\Vert \mathbf{x} - \mathbf{y} \Vert}_{2}^{2},
    \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{equation*}

Since \( C_{L}^{1} \subseteq C^{1} \), we only need to show that \( g \) and \( h \) have a monotone gradient to prove that \( g \) and \( h \) are convex, i.e.,
\begin{align*}
    {(\nabla g(\mathbf{x}) - \nabla g(\mathbf{y}))}^{\top} (\mathbf{x} - \mathbf{y})
    & \geq 0
    , \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
    \\
    {(\nabla h(\mathbf{x}) - \nabla h(\mathbf{y}))}^{\top} (\mathbf{x} - \mathbf{y})
    & \geq 0
    , \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{align*}

Now, with
\begin{equation*}
    \nabla g(\mathbf{x})
    =
    L \mathbf{x} - \nabla f(\mathbf{x})
    , \qquad
    \nabla h(\mathbf{x})
    =
    L \mathbf{x} + \nabla f(\mathbf{x})
\end{equation*}
\begin{align*}
    \implies
    &
    {(\nabla g(\mathbf{x}) - \nabla g(\mathbf{y}))}^{\top} (\mathbf{x} - \mathbf{y})
    \\ & =
    {\Big( L(\mathbf{x} - \mathbf{y}) - \big( \nabla f(\mathbf{x}) - \nabla f(\mathbf{y}) \big) \Big)}^{\top} (\mathbf{x} - \mathbf{y})
    \\ & =
    L {\Vert \mathbf{x} - \mathbf{y} \Vert}^{2}
    - {(\nabla f(\mathbf{x}) - \nabla f(\mathbf{y}))}^{\top} (\mathbf{x} - \mathbf{y})
    \\ & \geq
    L {\Vert \mathbf{x} - \mathbf{y} \Vert}^{2}
    - \big\vert {(\nabla f(\mathbf{x}) - \nabla f(\mathbf{y}))}^{\top} (\mathbf{x} - \mathbf{y}) \big\vert
    \quad (\because x \leq \vert x \vert \Rightarrow -x \geq -\vert x \vert, \; \forall x \in \mathbb{R})
    \\ & \geq
    L {\Vert \mathbf{x} - \mathbf{y} \Vert}^{2}
    - L {\Vert \mathbf{x} - \mathbf{y} \Vert}^{2}
    = 0,
    \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{align*}

Similarly, we get
\begin{align*}
    \implies
    &
    {(\nabla h(\mathbf{x}) - \nabla h(\mathbf{y}))}^{\top} (\mathbf{x} - \mathbf{y})
    \\ & =
    {\Big( L(\mathbf{x} - \mathbf{y}) + \big( \nabla f(\mathbf{x}) - \nabla f(\mathbf{y}) \big) \Big)}^{\top} (\mathbf{x} - \mathbf{y})
    \\ & =
    L {\Vert \mathbf{x} - \mathbf{y} \Vert}^{2}
    + {(\nabla f(\mathbf{x}) - \nabla f(\mathbf{y}))}^{\top} (\mathbf{x} - \mathbf{y})
    \\ & \geq
    L {\Vert \mathbf{x} - \mathbf{y} \Vert}^{2}
    - \big\vert {(\nabla f(\mathbf{x}) - \nabla f(\mathbf{y}))}^{\top} (\mathbf{x} - \mathbf{y}) \big\vert
    \quad (\because -x \leq \vert x \vert \Rightarrow x \geq -\vert x \vert, \; \forall x \in \mathbb{R})
    \\ & \geq
    L {\Vert \mathbf{x} - \mathbf{y} \Vert}^{2}
    - L {\Vert \mathbf{x} - \mathbf{y} \Vert}^{2}
    = 0,
    \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{align*}

Hence, \( g \) and \( h \) are convex.

Now, since \( g \) and \( h \) are convex, we have that
\begin{align*}
    g(\mathbf{y})
    & \geq
    g(\mathbf{x})
    + {\nabla g(\mathbf{x})}^{\top} (\mathbf{y} - \mathbf{x})
    , \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
    \\
    h(\mathbf{y})
    & \geq
    h(\mathbf{x})
    + {\nabla h(\mathbf{x})}^{\top} (\mathbf{y} - \mathbf{x})
    , \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{align*}

\begin{equation*}
    \implies
    \frac{L}{2} {\Vert \mathbf{y} \Vert}^{2} - f(\mathbf{y})
    \geq
    \frac{L}{2} {\Vert \mathbf{x} \Vert}^{2} - f(\mathbf{x})
    + {\Big( L \mathbf{x} - \nabla f(\mathbf{x}) \Big)}^{\top} (\mathbf{y} - \mathbf{x})
    , \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{equation*}
\begin{align*}
    \implies
    f(\mathbf{y}) - f(\mathbf{x}) - {\nabla f(\mathbf{x})}^{\top} (\mathbf{y} - \mathbf{x})
    & \leq
    \frac{L}{2} {\Big( {\Vert \mathbf{y} \Vert}^{2} - {\Vert \mathbf{x} \Vert}^{2} - 2 \mathbf{x}^{\top} (\mathbf{y} - \mathbf{x}) \Big)}
    \\ & =
    \frac{L}{2} \Big( \Vert \mathbf{y} \Vert^{2} - \cancel{ \Vert \mathbf{x} \Vert^{2} } - 2 \mathbf{x}^{\top} \mathbf{y} + \cancel{2} \Vert \mathbf{x} \Vert^{2} \Big)
    \\ & =
    \frac{L}{2} {\Vert \mathbf{y} - \mathbf{x} \Vert}^{2}
    , \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{align*}

Similarly, we get
\begin{equation*}
    \implies
    \frac{L}{2} {\Vert \mathbf{y} \Vert}^{2} + f(\mathbf{y})
    \geq
    \frac{L}{2} {\Vert \mathbf{x} \Vert}^{2} + f(\mathbf{x})
    + {\Big( L \mathbf{x} + \nabla f(\mathbf{x}) \Big)}^{\top} (\mathbf{y} - \mathbf{x})
    , \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{equation*}
\begin{align*}
    \implies
    f(\mathbf{y}) - f(\mathbf{x}) - {\nabla f(\mathbf{x})}^{\top} (\mathbf{y} - \mathbf{x})
    & \geq
    -\frac{L}{2} {\Big( {\Vert \mathbf{y} \Vert}^{2} - {\Vert \mathbf{x} \Vert}^{2} - 2 \mathbf{x}^{\top} (\mathbf{y} - \mathbf{x}) \Big)}
    \\ & =
    -\frac{L}{2} \Big( \Vert \mathbf{y} \Vert^{2} - \cancel{ \Vert \mathbf{x} \Vert^{2} } - 2 \mathbf{x}^{\top} \mathbf{y} + \cancel{2} \Vert \mathbf{x} \Vert^{2} \Big)
    \\ & =
    -\frac{L}{2} {\Vert \mathbf{y} - \mathbf{x} \Vert}^{2}
    , \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
\end{align*}

Hence, we have
\begin{equation*}
    \boxed{
        \Big\vert f(\mathbf{y}) - f(\mathbf{x}) - {\nabla f(\mathbf{x})}^{\top} (\mathbf{y} - \mathbf{x}) \Big\vert
        \leq
        \frac{L}{2} {\big\Vert \mathbf{y} - \mathbf{x} \big\Vert}^{2}
        , \quad \forall \mathbf{x}, \mathbf{y} \in \mathbb{R}^{n}
    }
\end{equation*}
