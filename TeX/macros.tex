%% macros.tex

\newcommand{\R}{{\mathbb{R}}}
\newcommand{\N}{{\mathbb{N}}}

\newcommand{\notimplies}{\mathrel{{\ooalign{\hidewidth\(\not{\phantom{=}}\)\hidewidth\cr\(\implies\)}}}}

\newcommand{\set}[1]{{\left\{#1\right\}}}
\newcommand{\given}{\;\middle|\;}
\newcommand\spanset[1]{{\mathrm{span}\set{#1}}}

\NewDocumentCommand{\abs}{om}{{\IfNoValueTF{#1}{\left\lvert#2\right\rvert}{#1\lvert#2#1\rvert}}}
\NewDocumentCommand{\norm}{om}{{\IfNoValueTF{#1}{\left\lVert#2\right\rVert}{#1\lVert#2#1\rVert}}}

\newcommand{\dotp}[2]{{{#1}^\top#2}}
\newcommand{\outp}[2]{{#1{#2}^\top}}
\ExplSyntaxOn{}
\NewDocumentCommand{\qf}{mmo}{
    \IfValueTF{#3}{
        \str_if_eq:nnT {#1} {#3} {
            \PackageWarning{macros}{Argument 3 not needed}
        }
        {#1}^\top#2\,#3
    }{
        {#1}^\top#2\,#1
    }
}
\ExplSyntaxOff{}

\newcommand{\inv}[1]{{{#1}^{-1}}}
\newcommand{\trace}[1]{\func{\mathrm{trace}}{#1}}
\newcommand{\determinant}[1]{\func{\mathrm{det}}{#1}}
\newcommand{\rank}[1]{\func{\mathrm{rank}}{#1}}
\newcommand{\diag}[1]{\func{\mathrm{diag}}{#1}}

\newcommand{\func}[2]{{#1\!\left(#2\right)}}
\newcommand{\grad}[2]{{\nabla\!\func{#1}{#2}}}
\newcommand{\hess}[2]{{\nabla^2\!\func{#1}{#2}}}
\newcommand{\hessinv}[2]{\inv{\left[\hess{#1}{#2}\right]}}

\LoopCommands{{argmin}{argmax}}[#1]{\newmathcommand#2{\mathop{\mathrm{#1}}}}
\LoopCommands{{minimize}{maximize}}[#1]{\DeclareMathOperator*{#2}{#1}}
\DeclareMathOperator{\subjectto}{subject~to}
\newcommand{\smalloh}[1]{\func{{\scriptstyle\mathcal{O}}}{#1}}

\newcommand{\SD}[1][d]{{\mathcal{S}_{#1}}}
\newcommand{\PSD}[1][d]{{\mathcal{S}^{+}_{#1}}}
\newcommand{\PD}[1][d]{{\mathcal{S}^{++}_{#1}}}

\newcommand{\C}{{\mathcal{C}}}

\LoopCommands{xyzpheIQABUV}[#1]{\newmathcommand#2{{\mathbf{#1}}}}
\LoopCommands{uv}[#1]{\renewmathcommand#2{{\mathbf{#1}}}}
\newcommand{\Qinv}{\inv{\mathbf{Q}}}

\newcommand{\xstar}{{\x^\ast}}
\newcommand{\xhat}{{\hat{\x}}}
\newcommand{\xk}{{\x^{(k)}}}
\newcommand{\pk}{{\p^{(k)}}}
\newcommand{\xkp}{{\x^{(k+1)}}}
\newcommand{\xzero}{{\x^{(0)}}}

\newcommand{\half}{{\frac{1}{2}}}
\newcommand{\zero}{{\mathbf{0}}}
