\documentclass[12pt,openany]{book}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amsfonts, amsmath, amssymb, amsthm, cancel, interval, latexsym, mathcommand, mathtools}
\usepackage{booktabs, enumitem, geometry, graphicx, hyperref, makeidx, microtype, titlesec, tocloft, xparse}
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\usepackage[most]{tcolorbox}
\usepackage[numbers,sort]{natbib}
\usepackage[dvipsnames]{xcolor}
\usepackage[notion,quotation]{knowledge}

\geometry{
    a4paper,
    left=1.2cm,
    right=1.2cm,
    top=2cm,
    bottom=2cm,
}

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    citecolor=red,
}

\raggedbottom{}
\makeindex{}

\makeatletter
\renewcommand{\part}[1]{
    \clearpage
    \refstepcounter{part}
    \addcontentsline{toc}{part}{\thepart\hspace{1em}#1}
    {\normalfont\huge\bfseries \thepart. #1}
}
\patchcmd{\chapter}{\cleardoublepage}{}{}{}
\patchcmd{\chapter}{\clearpage}{}{}{}
\makeatother
\renewcommand{\cfttoctitlefont}{\normalfont\LARGE\bfseries}
\setlength{\cftbeforetoctitleskip}{2em}
\setlength{\cftaftertoctitleskip}{0pt}
\setlength{\cftbeforepartskip}{1em}
\setlength{\cftbeforechapskip}{0.5em}
\setlength{\cftbeforesecskip}{0pt}
\titleformat{\chapter}[hang]{\normalfont\LARGE\bfseries}{\thechapter.}{0.5em}{}
\titlespacing*{\chapter}{0pt}{1em}{0.2em}
\titlespacing*{\section}{0pt}{0.7em}{0.2em}
\titlespacing*{\subsection}{0pt}{0.5em}{0.2em}
\titlespacing*{\subsubsection}{0pt}{0.3em}{0.2em}

\setlength{\parskip}{0pt}
\setlength{\parindent}{0pt}
\setlist{noitemsep, topsep=0pt}
\setcounter{tocdepth}{2}

\NewTcbTheorem[number within=section]{definition}{Definition}{
    colback=cyan!5!white,
    boxrule=0.8pt,
    fonttitle=\bfseries,
    enhanced,
}{def}
\NewTcbTheorem[number within=section]{theorem}{Theorem}{
    colback=green!5!white,
    boxrule=0.8pt,
    fonttitle=\bfseries,
    enhanced,
}{thm}
\NewTcbTheorem[number within=section]{lemma}{Lemma}{
    colback=green!5!white,
    boxrule=0.8pt,
    fonttitle=\bfseries,
    enhanced,
}{lem}
\NewTcbTheorem[number within=section]{corollary}{Corollary}{
    colback=yellow!5!white,
    boxrule=0.8pt,
    fonttitle=\bfseries,
    enhanced,
}{cor}

\intervalconfig{soft open fences}

\newcommand{\psecref}[1]{(\hyperref[#1]{\S\ref*{#1}})}
\newcommand{\peqref}[1]{(\hyperref[#1]{Eq.~\ref*{#1}})}
\newcommand{\pdefref}[1]{(\hyperref[#1]{Def.~\ref*{#1}})}
\newcommand{\pthmref}[1]{(\hyperref[#1]{Thm.~\ref*{#1}})}
\newcommand{\plemref}[1]{(\hyperref[#1]{Lem.~\ref*{#1}})}
\newcommand{\pcorref}[1]{(\hyperref[#1]{Cor.~\ref*{#1}})}
\newcommand{\palgref}[1]{(\hyperref[#1]{Alg.~\ref*{#1}})}

\input{macros.tex}
\input{knowledge.tex}

\begin{document}

\frontmatter{
    \input{sections/titlepage.tex}
    {\let\clearpage\relax \tableofcontents}
}
\mainmatter{
    \input{sections/introduction.tex}
    \input{sections/notation.tex}
    \input{sections/preliminaries.tex}
    \input{sections/unconstrained.tex}
    \input{sections/constrained.tex}
}
\backmatter{
    \renewcommand{\bibname}{References}
    \bibliographystyle{IEEEtran}
    \bibliography{sections/references.bib}

    \printindex{}
}

\end{document}
