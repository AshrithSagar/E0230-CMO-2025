\section*{Question 2}

Consider minimizing \( f \) defined in (\texttt{CQ})

\begin{enumerate}[label= (\alph*)]
    \item Let \( Q_{i i} = 1, i \in 1, \ldots, d \).
        Suppose \( \e_1, \ldots, \e_d \) be Q-conjugate.
        Recall the conjugate Direction algorithm.
        In the \( k \) th iteration we use \( \u_{k-1} = \e_{k}, k = 1, \ldots, d \), as the Conjugate Direction.
        Compute \( \x^k \), for all \( k = 1, \ldots, d \).
        Assume \( \x^0 = 0 \).

    \item Suppose now we use Conjugate Gradient Algorithm on the same setting (\( Q_{ii} = 1, i \in \{1, \ldots, d\} \)).
        State the outputs after every iteration.
\end{enumerate}

\subsection*{Solution}

\subsubsection*{(a) Conjugate Direction}

\begin{align*}
    \x^{k+1}
    & =
    \x^k
    -
    \frac{\dotp{\grad{f}{\x^k}}{\u_k}}{\qf{\u_k}{\Q}} \u_k,
    \quad k = 0, \ldots, d-1
    \\
    \implies
    \x^{k+1}
    & =
    \x^0
    -
    \sum_{i = 0}^{k}
    \frac{\dotp{\grad{f}{\x^i}}{\e_{i+1}}}{\qf{\e_{i+1}}{\Q}} \e_{i+1},
    \quad k = 0, \ldots, d-1
    \\
    \implies
    \x^k
    & =
    -
    \sum_{i = 0}^{k-1}
    \frac{\dotp{\grad{f}{\x^i}}{\e_{i+1}}}{\qf{\e_{i+1}}{\Q}} \e_{i+1},
    \quad k = 1, \ldots, d
    \\
    \because
    \grad{f}{\x}
    & =
    \Q \x + \h,
    \quad \forall \x \in \R^d
    \\
    \implies
    \x^k
    & =
    -
    \sum_{i = 0}^{k-1}
    \frac{\dotp{\pbrac{\Q \x^i + \h}}{\e_{i+1}}}{\qf{\e_{i+1}}{\Q}} \e_{i+1}
    \\ & =
    -
    \sum_{i = 0}^{k-1}
    \frac{\qf{\x^i}{\Q}[\e_{i+1}]}{\qf{\e_{i+1}}{\Q}} \e_{i+1}
    -
    \sum_{i = 0}^{k-1}
    \frac{\dotp{\h}{\e_{i+1}}}{\qf{\e_{i+1}}{\Q}} \e_{i+1},
    \quad k = 1, \ldots, d
    \\
    \implies
    \qf{\x^k}{\Q}[\e_{k+1}]
    & =
    -
    \sum_{i = 0}^{k-1}
    \frac{\qf{\x^i}{\Q}[\e_{i+1}]}{\qf{\e_{i+1}}{\Q}} \cancel{ \qf{\e_{i+1}}{\Q}[\e_{k+1}] }
    -
    \sum_{i = 0}^{k-1}
    \frac{\dotp{\h}{\e_{i+1}}}{\qf{\e_{i+1}}{\Q}} \cancel{ \qf{\e_{i+1}}{\Q}[\e_{k+1}] }
    \\ & =
    0,
    \quad k = 1, \ldots, d-1
    \\
    \implies
    \x^k
    & =
    -
    \sum_{i = 0}^{k-1}
    \frac{\dotp{\h}{\e_{i+1}}}{\qf{\e_{i+1}}{\Q}} \e_{i+1},
    \quad k = 1, \ldots, d
    \\
    \implies
    &
    \boxed{
        \x^k
        =
        -
        \sum_{i = 1}^{k}
        \frac{\dotp{\h}{\e_i}}{\qf{\e_i}{\Q}} \e_i,
        \quad k = 1, \ldots, d
    }
\end{align*}

Further,
\begin{align*}
    \x^k
    & =
    -
    \sum_{i = 1}^{k}
    h_i \e_i,
    \quad k = 1, \ldots, d
    \\
    \implies
    \x^d
    & =
    -
    \sum_{i = 1}^{d}
    h_i \e_i
    =
    -\h
\end{align*}

\subsubsection*{(b) Conjugate Gradient}

\begin{align*}
    \x^0
    & =
    \zero,
    \quad
    \r_0
    =
    \grad{f}{\x^0}
    =
    \h,
    \quad
    \u_0
    =
    -\r_0
    =
    -\h
    \\
    \alpha_k
    & =
    \frac{\dotp{\r_k}{\r_k}}{\qf{\u_k}{\Q}},
    \quad k = 0, \ldots, d-1
    \\
    \x^{k+1}
    & =
    \x^k
    +
    \alpha_k \u_k,
    \quad k = 0, \ldots, d-1
    \\
    \r_{k+1}
    & =
    \r_k
    +
    \alpha_k \Q \u_k
    =
    \grad{f}{\x^{k+1}},
    \quad k = 0, \ldots, d-1
    \\
    \beta_{k+1}
    & =
    \frac{\dotp{\r_{k+1}}{\r_{k+1}}}{\dotp{\r_k}{\r_k}},
    \quad k = 0, \ldots, d-1
    \\
    \u_{k+1}
    & =
    -\r_{k+1}
    +
    \beta_{k+1} \u_k,
    \quad k = 0, \ldots, d-1
\end{align*}
\begin{align*}
    \implies
    \beta_{k+2} \u_{k+1}
    & =
    -\beta_{k+2} \r_{k+1}
    +
    \beta_{k+2} \beta_{k+1} \u_k,
    \quad k = 0, \ldots, d-2
    \\
    \implies
    \beta_{k+1} \u_k
    & =
    -\beta_{k+1} \r_k
    +
    \beta_{k+1} \beta_k \u_{k-1},
    \quad k = 1, \ldots, d-1
    \\
    \implies
    \u_{k+1}
    & =
    -\r_{k+1}
    -
    \beta_{k+1} \r_{k}
    +
    \beta_{k+1} \beta_k \u_{k-1},
    \quad k = 1, \ldots, d-1
    \\
    \implies
    \u_k
    & =
    -\r_k
    -
    \sum_{i = 1}^{k-1}
    \pbrac{ \prod_{j = i+1}^{k} \beta_j } \r_i
    +
    \pbrac{ \prod_{j = 1}^{k} \beta_j } \u_0,
    \quad k = 1, \ldots, d
    \\
    \text{Now, }
    \prod_{j = i + 1}^{k} \beta_j
    & =
    \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_i}{\r_i}},
    \quad k = 1, \ldots, d, \quad i = 0, \ldots, k-1
    \\
    \implies
    \prod_{j = 1}^{k} \beta_j
    & =
    \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_0}{\r_0}},
    \quad k = 1, \ldots, d
    \\
    \implies
    \u_k
    & =
    -\r_k
    -
    \sum_{i = 1}^{k-1}
    \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_i}{\r_i}} \r_i
    +
    \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_0}{\r_0}} \u_0,
    \quad k = 1, \ldots, d
    \\
    \implies
    \u_k
    & =
    -\r_k
    -
    \sum_{i = 0}^{k-1}
    \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_i}{\r_i}} \r_i,
    \quad k = 1, \ldots, d
    \\ & =
    -
    \sum_{i = 0}^{k}
    \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_i}{\r_i}} \r_i,
    \quad k = 1, \ldots, d
    \\
    \text{Also, }
    \because
    \u_0
    & =
    -\r_0
\end{align*}
\begin{equation*}
    \implies
    \boxed{
        \u_k
        =
        -
        \sum_{i = 0}^{k}
        \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_i}{\r_i}} \r_i,
        \quad k = 0, \ldots, d
    }
\end{equation*}
\begin{align*}
    \implies
    \qf{\u_k}{\Q}
    & =
    \qf{
        \pbrac{
            \sum_{i = 0}^{k}
            \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_i}{\r_i}} \r_i
        }
    }{\Q}[
        \pbrac{
            \sum_{j = 0}^{k}
            \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_j}{\r_j}} \r_j
        }
    ]
    \\ & =
    \sum_{i = 0}^{k}
    \sum_{j = 0}^{k}
    \frac{\pbrac{\dotp{\r_k}{\r_k}}^2}{\dotp{\r_i}{\r_i} \dotp{\r_j}{\r_j}}
    \qf{\r_i}{\Q}[\r_j]
\end{align*}
\begin{align*}
    \implies
    \r_{k+1}
    & =
    \r_k
    -
    \alpha_k
    \sum_{i = 0}^{k}
    \frac{\dotp{\r_k}{\r_k}}{\dotp{\r_i}{\r_i}} \Q \r_i,
    \quad k = 0, \ldots, d-1
\end{align*}
