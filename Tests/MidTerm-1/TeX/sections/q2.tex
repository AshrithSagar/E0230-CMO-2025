\section*{Question 2}

Let \( f: \R^{d} \rightarrow \R \) be \( \classC^1_L \).
Consider implementing the Wolfe method of inexact line search for the Algorithm \texttt{DESCENT}.
\begin{enumerate}[label= (\alph*)]
    \item State the Wolfe conditions.

    \item Compute the minimum guaranteed stepsize at \( \x^k \).

    \item Does the Wolfe method satisfy the Sufficient Decrease Lemma.
        Justify.
\end{enumerate}

\subsection*{Solution}

\subsection*{(a) Wolfe conditions}

\begin{align*}
    \func{f}{\x^k + \alpha_k \p^k}
    & \leq
    \func{f}{\x^k} + c_1 \alpha_k \dotp{\grad{f}{\x^k}}{\p^k}
    \tag{sufficient decrease}
    \\
    \dotp{\grad{f}{\x^k + \alpha_k \p^k}}{\p^k}
    & \geq
    c_2 \dotp{\grad{f}{\x^k}}{\p^k}
    \tag{curvature}
    \\
    \text{where } \;&
    0 < c_1 < c_2 < 1
\end{align*}
\begin{align*}
    \func{g}{\alpha_k}
    & \leq
    \func{g}{0} + c_1 \alpha_k \func{g^\prime}{0}
    \tag{sufficient decrease}
    \\
    \func{g^\prime}{\alpha_k}
    & \geq
    c_2 \func{g^\prime}{0}
    \tag{curvature}
    \\
    \text{where } \;&
    0 < c_1 < c_2 < 1,
    \\ &
    \func{g}{\alpha}
    \triangleq
    \func{f}{\x^k + \alpha \p^k}
    \implies
    \func{g^\prime}{\alpha}
    =
    \dotp{\grad{f}{\x^k + \alpha \p^k}}{\p^k}
\end{align*}

\subsection*{(b) Minimum guaranteed stepsize at \( \x^k \)}

Since \( f \in \classC^1_L \), we have
\begin{align*}
    \norm{\grad{f}{\y} - \grad{f}{\x}}
    & \leq
    L \norm{\y - \x},
    \quad
    \forall \x, \y \in \R^d
    \\
    \implies
    \norm{\grad{f}{\x^k + \alpha \p^k} - \grad{f}{\x^k}}
    & \leq
    L \norm{\alpha \p^k}
    =
    L \alpha \norm{\p^k},
    \quad
    \forall \alpha > 0
\end{align*}

Now, from the curvature condition, we have
\begin{align*}
    \implies
    c_2 \dotp{\grad{f}{\x^k}}{\p^k}
    & \leq
    \dotp{\grad{f}{\x^k + \alpha_k \p^k}}{\p^k}
    \\
    \implies
    (c_2 - 1) \dotp{\grad{f}{\x^k}}{\p^k}
    & \leq
    \dotp{\Big( \grad{f}{\x^k + \alpha_k \p^k} - \grad{f}{\x^k} \Big)}{\p^k}
    \\
\end{align*}
Now, by Cauchy-Schwarz inequality, we get
\begin{align*}
    \implies
    \abs{\dotp{\Big( \grad{f}{\x^k + \alpha_k \p^k} - \grad{f}{\x^k} \Big)}{\p^k}}
    & \leq
    \norm{\grad{f}{\x^k + \alpha_k \p^k} - \grad{f}{\x^k}}
    \; \norm{\p^k}
    \\ & \leq
    L \alpha_k \norm{\p^k}^2
\end{align*}
And since \( x \leq \abs{x}, \; \forall x \in \R \), we finally get
\begin{align*}
    \implies
    (c_2 - 1) \dotp{\grad{f}{\x^k}}{\p^k}
    & \leq
    L \alpha_k \norm{\p^k}^2
\end{align*}
\begin{equation*}
    \implies
    \boxed{
        \alpha_k
        \geq
        \frac{(c_2 - 1)}{L}
        \frac{\dotp{\grad{f}{\x^k}}{\p^k}}{\norm{\p^k}^2}
    }
    > 0
\end{equation*}

\subsection*{(c) Sufficient decrease lemma}

Yes, the Wolfe method satisfies the sufficient decrease lemma.

Sufficient decrease lemma states
\begin{equation*}
    \frac{\func{f}{\x^k} - \func{f}{\x^k + \alpha_k \p^k}}{\norm{\grad{f}{\x^k}}^2}
    \geq
    R_k
    \geq
    R
    > 0
\end{equation*}
\begin{align*}
    \implies
    \func{f}{\x^k + \alpha_k \p^k}
    & \leq
    \func{f}{\x^k} + c_1 \alpha_k \dotp{\grad{f}{\x^k}}{\p^k}
    \\
    \implies
    \func{f}{\x^k} - \func{f}{\x^k + \alpha_k \p^k}
    & \geq
    - c_1 \alpha_k \dotp{\grad{f}{\x^k}}{\p^k}
\end{align*}
Since \( -x \geq -\abs{x}, \; \forall x \in \R \),
and by Cauchy-Schwarz inequality, we get
\begin{align*}
    \implies
    - c_1 \alpha_k \dotp{\grad{f}{\x^k}}{\p^k}
    & \geq
    - c_1 \alpha_k \abs{\dotp{\grad{f}{\x^k}}{\p^k}}
    \\
    \abs{\dotp{\grad{f}{\x^k}}{\p^k}}
    & \leq
    \norm{\grad{f}{\x^k}}
    \; \norm{\p^k}
    \\
    \implies
    - c_1 \alpha_k \abs{\dotp{\grad{f}{\x^k}}{\p^k}}
    & \geq
    - c_1 \alpha_k \norm{\grad{f}{\x^k}}
    \; \norm{\p^k}
    \\
    \implies
    \func{f}{\x^k} - \func{f}{\x^k + \alpha_k \p^k}
    & \geq
    - c_1 \alpha_k \norm{\grad{f}{\x^k}}
    \; \norm{\p^k}
    \\
    \because
    \alpha_k
    & \geq
    \frac{(c_2 - 1)}{L}
    \frac{\dotp{\grad{f}{\x^k}}{\p^k}}{\norm{\p^k}^2}
    \\
    \implies
    \func{f}{\x^k} - \func{f}{\x^k + \alpha_k \p^k}
    & \geq
    - c_1
    \frac{(c_2 - 1)}{L}
    \frac{\dotp{\grad{f}{\x^k}}{\p^k}}{\norm{\p^k}^2}
    \norm{\grad{f}{\x^k}}
    \; \norm{\p^k}
    \\
    \implies
    \frac{\func{f}{\x^k} - \func{f}{\x^k + \alpha_k \p^k}}{\norm{\grad{f}{\x^k}}^2}
    & \geq
    - c_1
    \frac{(c_2 - 1)}{L}
    \frac{\dotp{\grad{f}{\x^k}}{\p^k}}{\norm{\grad{f}{\x^k}} \norm{\p^k}}
    \\
    \implies
    R_k
    & \triangleq
    - c_1
    \frac{(c_2 - 1)}{L}
    \frac{\dotp{\grad{f}{\x^k}}{\p^k}}{\norm{\grad{f}{\x^k}} \norm{\p^k}}
    \\
    \because
    -1
    & \leq
    \frac{\dotp{\grad{f}{\x^k}}{\p^k}}{\norm{\grad{f}{\x^k}} \norm{\p^k}}
    \leq
    1
    \\
    \implies
    - \frac{\dotp{\grad{f}{\x^k}}{\p^k}}{\norm{\grad{f}{\x^k}} \norm{\p^k}}
    & \geq
    - 1
    \\
    \implies
    R_k
    & \geq
    - c_1
    \frac{(c_2 - 1)}{L}
    =
    \frac{c_1 (1 - c_2)}{L}
    \\
    \implies
    R
    & \triangleq
    \frac{c_1 (1 - c_2)}{L}
\end{align*}

Thus, the Wolfe method satisfies the sufficient decrease lemma with
\begin{equation*}
    \boxed{
        R
        =
        \frac{c_1 (1 - c_2)}{L}
    }
    > 0
\end{equation*}
since \( 0 < c_1 < c_2 < 1 \) and \( L > 0 \).
